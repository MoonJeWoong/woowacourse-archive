# LV2 12주차 (23.04.24 ~ 23.04.30)

---

## 23.04.25 
### 스프링 테스트 강의
- 현업에 들어가면 회고고 나발이고 피처 치는데 급급해질 수 있는데 지금 개발자로서 살아가면서 성장에 필요한 것들을 경험할 수 있었으면 좋겠다.
- 이번 미션에는 전 구간 기능 테스트 구현에 집중해보자.
- 학습 자체를 주도적으로, 능동적으로 해야된다.
- 자기객관화가 안되면 학습이 힘들 수 있다.
  - 레벨2에서 학습하는 활동 목적이 추상적이고 모호해서 끝이 없는 학습을 하고 있는 건 아닌지?
  - 방향성과 목표가 중요하다.

주간회고 - 레벨2의 목표와 계획 세워보기

한번 세운 목표와 계획은 끝까지 가야하나?
아니다. 계속 생각하고 개선이 필요하다.
- 레벨2 끝날 때 내가 세운 목표를 달성했을 때 내 모습이 만족스러울까?
- 계획을 완수하면 목표를 달성하는 것인가?

#### Spring MVC with template engine
- 기존 Json이나 데이터를 내려주던 엔진과 다르게 페이지를 내려주는 템플릿 엔진에 대해 알아볼 것이다.
  - 첫 미션에서는 Spring MVC Annotation을 이용해 웹 요청/응답을 해보는 경험 + Exception 처리 경험 등을 해봤을 것이다.
  - 사실 이 부분은 학습할 양이 굉장히 많아 보이는데 어느정도 사용방식에 대한 것들이 정형화되어 있기 때문에 익숙해지면 괜찮아진다.
  - 컨트롤러에서 어떤 페이지를 보여줄 지 정하고 해당 페이지를 view로부터 받아와서 브라우저에 응답을 쏴준다.
  - 디스패처 서블릿을 학습하면서 다시 알게되겠지만 어떻게 페이지를 만들고 싶은지에 따라 뷰는 달라진다. (템플릿 엔진도 달라진다.)
  - 템플릿 엔진과 뷰가 헷갈릴 수 있다.
    - 뷰는 render라는 메서드가 있는데 이 결과물로 HTML 형식의 페이지가 나온다.
    - 컨트롤러에서 String을 반환하면 선택된 뷰는 여러 템플릿 엔진 중 어떤 엔진을 사용해 페이지를 렌더링할 것인지 찾게 된다.
      - templates 하위 탐색
    - 템플릿 엔진은 렌더링 완료된 페이지를 다시 view로 넘긴다.
  - 만약 학습 테스트트를 찾아봤는데 못찾았다. 어떻게 해야하지
    - 공식 문서 등에서 코드로 다루지 않는 부분들이 많다. 직접 고민하고 왜쓰는지 생각해보고 코드로 작성해본 경험을 해야 기억에 오래 남고 내것이 된다.
    - 무조건 혼자 해결하려고 생각하는 것보다는 주변 사람들에게 도움을 받아보려고 하는 것이 좋다.
    - 예제코드가 없는 경우 학습하는 입장에서는 굉장히 어려울 수 있다.
      - 이론과 실습간의 밸런스가 무너진 상태라 학습이 어려운 상태인데 일단 그 시점에서 놔두는 것을 추천한다.
      - 다른 개념들을 공부하고 시간을 좀 더 들이다보면 다시 이해할 수 있는 시기가 돌아올 것이다.
      - 어떤 내용인지에 따라 달라질 수 있지만, 예제 코드 자체가 없는 내용이라면 지금 ‘사용’ 측면에서 학습할 주제가 맞나 의심이 될 것 같긴 하네요 ㅎㅎ (브리)
- Test with Spring

- 미션 진행하면서 CRUD API 설계에 대한 고민과 삽질을 많이 해와라 + 2단계에서는 인증 관련 기능 구현 삽질 많이 해보기
- 레벨2는 프리코스 없이 바로 미션을 하다보니 달랐는데 이제는 스프링을 어떻게 잘 짤 수 있을지에 대한 고민을 해보면 좋겠다.
- 가장 먼저 떠오르는 방법은 테스트 코드를 짜서 내 코드에 대한 확신을 챙기는 것이다.
- 레벨1에서는 Junit 기반의 콘솔 테스트를 진행했었다.
  - 컨트롤러 서비스 dao로 웹 어플리케이션을 나눈다면 어디가 가장 테스트를 먼저 작성해야 할까?
  - 계층 부분부분마다 진행해야 하는 테스트도 있지만 부분 통합 테스트, 전체 통합 테스트가 필요해지는 경우도 있다.
  - 이번 시간에는 클라이언트 대상으로 요청을 하고 응답을 받는 과정에 대한 테스트를 학습한다.
  - 어떤 테스트인지에 대한 용어에 집착하지 말고 목적과 점증 대상에 집중하라!
- 요청하는 대상을 테스트 코드로 구현하고
- 테스트 웹 어플리케이션을 작성해서 여기에 보내서 받는 것을 테스트한다.

- 웹 어플리케이션을 띄우는데 여러가지 객체들을 빈으로 등록하는데 @SpringBootTest를 테스트 메서드에 사용하면 이러한 테스트 환경을 쉽게 구축할 수 있도록 해준다.
- webEnvironment
- Random_port, Defined_port를 사용하면 실제 웹 서버가 뜬다.
- NONE : 등록된 스프링 빈만 가지고 테스트를 진행하겠다.
- Mock : 실제 서버를 띄우지는 않는다. 하지만 실제처럼 요청을 처리해주는 가짜 웹 환경을 구성해준다.
  - 이번 미션에서는 실제 서버를 띄워서 테스트를 진행한다.
  - 관심 있으면 학습 자료에 소개된 키워드를 찾아보자.

- WebMvcTest 어노테이션을 사용하면 presentation 레이어 객체들만 띄워서 테스트 환경을 구축하는 방식을 사용할 수 있다.

- 우리는 restAssured를 사용할 것이다. (웹 서버에 보내는 테스트 코드 객체를 만드는 역할)
given에는 헤더, 바디값 설정 등 메세지 전송 전 처리해야 하는 작업들
when에는 어떤 정보가 담긴 메세지를 보낼 것인지
then에는 요청에 대한 응답 결과를 받는다.

요청에 대한 결과값을 검증하는 방식으로 테스트를 진행할 수 있다.
왜 부분이 아닌 전체를 검증할까? 부분 vs 전체 무엇이 더 중요할까?


## 23.04.27
### 패캠 강의 정리
- @Component를 붙여서 스프링 빈으로 관리할 수 있다.
  - 인터페이스 타입을 인자로 받아서 어떤 빈이 주입되어야 하는지 모호한 경우 @Qualifier 어노테이션을 통해 기본적으로 생성될 빈의 이름을 설정해줄 수 있다.
- 클래스에 @Configuration 어노테이션을 사용하면 해당 클래스 내 메서드를 정의해서 빈을 직접 등록해줄 수 있다.
  - 내부 정의 메서드에 @Bean 어노테이션을 붙이면 반환하는 객체 타입을 빈으로 등록해 사용할 수 있게 된다.


## 23.04.28
### 웹 API 디자인 (장바구니 피드백 1 강의)
- 오늘은 피드백 위주로 진행할 것이다.
- 저희는 미션 상 DB에 데이터를 저장하고 있습니다. 그런데 ResponseEntity에서 created 메서드를 사용하면 생성된 데이터의 URI를 반환하도록 하더라구요.
- 이런 경우에는 어떤 URI를 반환하도록 하는 것이 좋은가요?
  - HTTP 명세 중 Location이라는 헤더를 다루는 것들이 있는데 이를 학습해보면 좋을 것 같다.
  - 허브는 상세보기 페이지를 만들어서 해당 URI를 리턴하는 방식으로 했다는 것 같다.


- 웹기반 서비스를 구축한다고 했을 때 클라이언트와 서버라는 계층이 나눠져있다.
- 그 사이에 리퀘스트, 리스폰스 행위로 데이터를 주고 받는다.
- 리퀘스트 리스폰스를 잘 설계하는 것이 왜 중요할까?
  - 혼자서 클라이언트와 서버를 모두 개발하는 것이 아니라면 소통이 중요하기 떄문이다.
- API 설계란?
  - 일련의 규칙을 만드는 것.
- http1.1 에 대한 명세를 보고 싶다면 RFC 2616 문서를 본다.
  - 그 중에서도 header와 관련된 내용을 더 보고 싶다면 RFC header라고 검사해본다.
- HTTP가 있는데 굳이 왜 API 설계를 따로 해줘야되나?
  - 우리 서비스에 알맞은 규약(프로토콜)은 정의되어 있지 않다.
  - 그래서 HTTP 명세만으로는 클라이언트가 원하는 정보를 제공해주기 부족하다.
  - 우리는 그래서 HTTP를 이용해서 API를 설계하는 것이다.
  - HTTP 외에도 다른 프로토콜들도 많이 존재하기 때문에 나중에 이를 이용해서도 설계할 수 있다.

- 좋은 API 설계란?
  - 왜 API설계를 꼭 잘해야 하는걸까?
  - 그냥 서버와 클라이언트가 약속을 잘 하면 되는 거 아닌가?
    - 한 번 정해진 API는 바꾸기가 쉽지 않다.
      - API 변경에 클라이언트가 영향을 받기 때문이다.
    - 항상 새로운 데이터 요소와 비즈니스 규칙이 계속 추가될 가능성은 존재한다.
    - 이럴 때 잘 설계된 API는 커뮤니케이션 비용등을 절감시켜준다.
  - 이미 IT 대기업들이 잘 설계해둔 API를 따라가면 안되나?
    - 실제로 이러한 API들을 많이 참고하기는 한다.
    - API 설계를 표준화하려는 시도를 하기는 했었으나 각 서비스들마다 요구사항이 다르고 환경이 다르기 때문에 포기되었다고 한다.
    - 보통 API를 설계할 떄는 자신들만의 설계를 원하는 경향이 있다.
- REST란?
  - 웹과 같은 시스템이 어떤 방식으로 동작해야 하는지 몇 가지 제약 조건으로 정리해둔 것.
  - 실제 REST는 RFC 문서보다 더 높은 수준의 추상화를 다룬다.
  - HTTP 명세가 어떤 것이고 이를 기반으로 어떻게 API를 설계할 것인지 생각하는 것이 더 중요하다.
  - Rest API 또는 Restful API 규칙이라고 불리우는 것은 참고만 하기
- 용어 설명
  - 리소스
    - 우리가 구현하는 자바 객체와 DB에 저장된 테이블과 리소스는 다를 수 있다.(즉 같을 때도 있다는 소리)
    - 서비스가 어떤 자원을 제공할 수 있는지에 집중한다고 생각하면 된다.
    - 리소스는 서버로부터 얻을 수 있는 데이터 혹은 페이지 등이 될 수 있다.
    - 자원이라는 것은 URI로 식별이 가능해야 한다.
    - 리소스는 네트워크 데이터 개체로 클라이언트가 얻길 원하는 것으로서 서버가 내려줄 수 있어야 한다.
  - URI
    - path와 query로 구성된다.
      - path는 계층적 형태로, query는 비계층적 형태로 구성된 데이터이다.
  - 리소스의 표현?
    - 우리는 레이싱카가 저장된 URI로 데이터를 요청한다고 해서 실제 레이싱카를 전달받는 것이 아니다.
    - 서버는 레이싱 카의 상태를 표현한 정보를 보내준다.
    - 헤더의 content-type 등을 통해서 클라이언트가 리소스에 get요청을 보냈을 떄 서버는 그 리소스를 나타내는 방법을 제공해야 한다.
    - 만약 여러개의 표현이 있는 리소스라면?
      - 클라이언트가 어떤 타입의 데이터를 원하는지 명시한 Accept 헤더 값을 확인해서 값을 반환한다.
    - 컨텐츠 협상 : 내가 원하는 데이터가 뭔지 알리고 받는 개념인데 추가 학습해보면 좋다.
    - 나중에 유명한 API들을 살펴보다 보면 왜 그렇게 설계했는지 생각하면서 봐보자.
  - 많이 사용하는 API 설계
  - 리소스 네이밍 가이드를 참고해서 진행해보자.
    - 다만 무조건적으로 따르지 말고 왜 이렇게 하는지 생각을 해보자.
    - restfulapi.net 페이지를 참고해서 진행했다고 한다.


### 우플비 패캠 실습 강의 수강
- AOP (Aspect Oriented Programming)
  - 관점 지향 프로그래밍
  - 프로그램을 개발할 때 서로 다른 기능들에 대해서 혹은 서로 다른 벤더사에 대해서 공통적인 관심사가 생길 수 있는데 이를 횡단 관심이라고 한다.
  - Method Parameter Log, 실행시간 Log, Parameter Encode 등의 작업들을 예로 들 수 있다.

- 주요 어노테이션
  - @Aspect : 자바에서 널리 사용하는 AOP 프레임워크에 포함되며, AOP를 정의하는 클래스에 할당한다.
  - @PointCut : 기능을 어디에 적용시킬지, 메소드, annotation 등 AOP를 적용시킬 지점을 설정한다.
  - @Before : 메소드를 실행하기 이전에 수행되는 것
  - @After : 메소드가 성공적으로 실행되거나 예외가 발생하더라도 실행된다.
  - @AfterReturning : 메소드 호출 성공 실행 시 수행하는 기능
  - @AfterThrowing : 메소드 호출 실패 예외 발생 시 수행하는 기능
  - @Around : Before/After 모두 제어

- 스프링에서 configuration, component, bean의 차이
  - 스프링에서 Component는 클래스 단위로 붙여서 빈으로 등록하기 위한 어노테이션이다.
  - @Bean은 스프링 Configure 어노테이션을 사용해서 전체적인 설정을 진행하는 클래스의 메서드에 붙여서 메서드의 반환 객체를 빈으로 관리하기 위한 어노테이션이다.

















